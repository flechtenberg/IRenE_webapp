
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://flechtenberg.github.io/IRenE_webapp/processing/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../app/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Processing Module - IRenE Webapp Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#processing-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="IRenE Webapp Documentation" class="md-header__button md-logo" aria-label="IRenE Webapp Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IRenE Webapp Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Processing Module
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="IRenE Webapp Documentation" class="md-nav__button md-logo" aria-label="IRenE Webapp Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    IRenE Webapp Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Processing Module
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Processing Module
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#backend.processing" class="md-nav__link">
    <span class="md-ellipsis">
      processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.PDFProcessingError" class="md-nav__link">
    <span class="md-ellipsis">
      PDFProcessingError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.construct_search_query" class="md-nav__link">
    <span class="md-ellipsis">
      construct_search_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.execute_search_scopus" class="md-nav__link">
    <span class="md-ellipsis">
      execute_search_scopus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.extract_seed" class="md-nav__link">
    <span class="md-ellipsis">
      extract_seed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.extract_text_from_pdf" class="md-nav__link">
    <span class="md-ellipsis">
      extract_text_from_pdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.get_keywords" class="md-nav__link">
    <span class="md-ellipsis">
      get_keywords
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.preprocess_text" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_text
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.scopus_sampling_process" class="md-nav__link">
    <span class="md-ellipsis">
      scopus_sampling_process
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.weighted_random_selection" class="md-nav__link">
    <span class="md-ellipsis">
      weighted_random_selection
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    App Module
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#backend.processing" class="md-nav__link">
    <span class="md-ellipsis">
      processing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.PDFProcessingError" class="md-nav__link">
    <span class="md-ellipsis">
      PDFProcessingError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.construct_search_query" class="md-nav__link">
    <span class="md-ellipsis">
      construct_search_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.execute_search_scopus" class="md-nav__link">
    <span class="md-ellipsis">
      execute_search_scopus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.extract_seed" class="md-nav__link">
    <span class="md-ellipsis">
      extract_seed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.extract_text_from_pdf" class="md-nav__link">
    <span class="md-ellipsis">
      extract_text_from_pdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.get_keywords" class="md-nav__link">
    <span class="md-ellipsis">
      get_keywords
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.preprocess_text" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_text
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.scopus_sampling_process" class="md-nav__link">
    <span class="md-ellipsis">
      scopus_sampling_process
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.processing.weighted_random_selection" class="md-nav__link">
    <span class="md-ellipsis">
      weighted_random_selection
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="processing-module">Processing Module</h1>


<div class="doc doc-object doc-module">



<a id="backend.processing"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="backend.processing.PDFProcessingError" class="doc doc-heading">
            <code>PDFProcessingError</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


        <p>Custom exception for PDF processing errors.</p>

              <details class="quote">
                <summary>Source code in <code>backend\processing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PDFProcessingError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom exception for PDF processing errors.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="backend.processing.construct_search_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">construct_search_query</span><span class="p">(</span><span class="n">selected_keywords</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Construct a search query string using logical AND.</p>

            <details class="quote">
              <summary>Source code in <code>backend\processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">construct_search_query</span><span class="p">(</span><span class="n">selected_keywords</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Construct a search query string using logical AND.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39; AND &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selected_keywords</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="backend.processing.execute_search_scopus" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute_search_scopus</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">scopus_api_key</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Execute the search query using the Scopus API via elsapy.</p>
<p>Parameters:
- query: Search query string.
- scopus_api_key: Dict containing 'apikey' and 'insttoken'.</p>
<p>Returns:
- match_count: Number of matching articles.
- matched_papers: Set of unique paper identifiers (e.g., Links).</p>

            <details class="quote">
              <summary>Source code in <code>backend\processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">execute_search_scopus</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">scopus_api_key</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute the search query using the Scopus API via elsapy.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - query: Search query string.</span>
<span class="sd">    - scopus_api_key: Dict containing &#39;apikey&#39; and &#39;insttoken&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - match_count: Number of matching articles.</span>
<span class="sd">    - matched_papers: Set of unique paper identifiers (e.g., Links).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;X-ELS-APIKey&#39;</span><span class="p">:</span> <span class="n">scopus_api_key</span><span class="p">[</span><span class="s1">&#39;apikey&#39;</span><span class="p">],</span>
        <span class="s1">&#39;X-ELS-Insttoken&#39;</span><span class="p">:</span> <span class="n">scopus_api_key</span><span class="p">[</span><span class="s1">&#39;insttoken&#39;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">client</span> <span class="o">=</span> <span class="n">ElsClient</span><span class="p">(</span><span class="n">scopus_api_key</span><span class="p">[</span><span class="s1">&#39;apikey&#39;</span><span class="p">])</span>
    <span class="n">client</span><span class="o">.</span><span class="n">inst_token</span> <span class="o">=</span> <span class="n">scopus_api_key</span><span class="p">[</span><span class="s1">&#39;insttoken&#39;</span><span class="p">]</span>

    <span class="n">search_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;TITLE-ABS-KEY(</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">)&#39;</span>
    <span class="n">doc_srch</span> <span class="o">=</span> <span class="n">ElsSearch</span><span class="p">(</span><span class="n">search_query</span><span class="p">,</span> <span class="s1">&#39;scopus&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">doc_srch</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">get_all</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">num_results</span> <span class="o">=</span> <span class="n">doc_srch</span><span class="o">.</span><span class="n">tot_num_res</span>

        <span class="k">if</span> <span class="n">num_results</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">num_results</span> <span class="o">&lt;=</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="n">doc_srch</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">get_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">doc_srch</span><span class="o">.</span><span class="n">results</span>
            <span class="n">matched_papers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">paper_info</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;scopus_id&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dc:identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;SCOPUS_ID:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;first_author&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dc:creator&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;prism:coverDate&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)[:</span><span class="mi">4</span><span class="p">],</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dc:title&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;journal&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;prism:publicationName&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;citations&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;citedby-count&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;open_access&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;openaccess&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;link&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="p">[{}])[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;@href&#39;</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">)</span>  <span class="c1"># Usually the third link is the scopus link</span>
                <span class="p">}</span>
                <span class="n">matched_papers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">paper_info</span><span class="p">)</span>
            <span class="n">match_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matched_papers</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">match_count</span><span class="p">,</span> <span class="n">matched_papers</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">num_results</span><span class="p">,</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">except</span> <span class="n">RequestException</span> <span class="k">as</span> <span class="n">req_err</span><span class="p">:</span>
        <span class="c1"># Handle issues with network or API request</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Network or API request error during Scopus API call: </span><span class="si">{</span><span class="n">req_err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">key_err</span><span class="p">:</span>
        <span class="c1"># Handle missing data in the response</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing expected data in Scopus API response: </span><span class="si">{</span><span class="n">key_err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># General catch-all for other unforeseen errors</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected error during Scopus API call: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="backend.processing.extract_seed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_seed</span><span class="p">(</span><span class="n">files</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Extract text from a list of uploaded PDF files and return a list of preprocessed strings.</p>
<p>Each element in the returned list corresponds to the text content of one PDF document.
The text is preprocessed (e.g., cleaned of stopwords and punctuation) for further use.</p>
<p>Parameters:
- files (list): A list of PDF files uploaded by the user.</p>
<p>Returns:
- list: A list of preprocessed text strings, where each string represents the content of one PDF file.</p>

            <details class="quote">
              <summary>Source code in <code>backend\processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_seed</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract text from a list of uploaded PDF files and return a list of preprocessed strings.</span>

<span class="sd">    Each element in the returned list corresponds to the text content of one PDF document.</span>
<span class="sd">    The text is preprocessed (e.g., cleaned of stopwords and punctuation) for further use.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - files (list): A list of PDF files uploaded by the user.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - list: A list of preprocessed text strings, where each string represents the content of one PDF file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seed_texts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">extract_text_from_pdf</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">seed_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">seed_texts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="backend.processing.extract_text_from_pdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_text_from_pdf</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Extract and preprocess text from a single PDF file.</p>
<p>This function reads through all the pages of the provided PDF file, extracts the text, and performs preprocessing
(such as cleaning, lowercasing, and tokenization) on the extracted text for further use in natural language processing tasks.</p>
<p>Parameters:
- file: A PDF file object from which text needs to be extracted.</p>
<p>Returns:
- str: A single preprocessed string containing the combined text from all pages of the PDF, ready for further analysis.</p>

            <details class="quote">
              <summary>Source code in <code>backend\processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_text_from_pdf</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract and preprocess text from a single PDF file.</span>

<span class="sd">    This function reads through all the pages of the provided PDF file, extracts the text, and performs preprocessing</span>
<span class="sd">    (such as cleaning, lowercasing, and tokenization) on the extracted text for further use in natural language processing tasks.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - file: A PDF file object from which text needs to be extracted.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - str: A single preprocessed string containing the combined text from all pages of the PDF, ready for further analysis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfReader</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
            <span class="n">extracted_text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">extract_text</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">extracted_text</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="n">extracted_text</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>

        <span class="c1"># Preprocess the extracted text</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">preprocess_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">text</span>

    <span class="k">except</span> <span class="n">PdfReadError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Raise a custom error and stop processing</span>
        <span class="k">raise</span> <span class="n">PDFProcessingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing PDF file &#39;</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Raise a custom error for any other general issue</span>
        <span class="k">raise</span> <span class="n">PDFProcessingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An unexpected error occurred while processing &#39;</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="backend.processing.get_keywords" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_keywords</span><span class="p">(</span><span class="n">seed_texts</span><span class="p">,</span> <span class="n">num_keywords</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Extract the top 'num_keywords' keywords from a list of documents using TF-IDF (Term Frequency-Inverse Document Frequency).</p>
<p>This function performs the following steps:
- Combines custom stop words with standard English stop words.
- Initializes a TfidfVectorizer to convert the text data into a matrix of TF-IDF features, considering unigrams only.
- Fits the TF-IDF model to the provided documents (seed_texts).
- Sums the TF-IDF scores across all documents to rank the importance of each keyword.
- Filters out numbers and stop words from the resulting keywords.</p>
<p>Parameters:
- seed_texts (list of str): A list where each element represents the (filtered) text of a document.
- num_keywords (int): The number of top keywords to extract.</p>
        <ul>
<li>list of dict: A list of dictionaries containing the top keywords and their corresponding TF-IDF scores.
  Each dictionary has two keys:<ul>
<li>'word': The keyword.</li>
<li>'weight': The TF-IDF score, rounded to two decimal places.</li>
</ul>
</li>
</ul>

            <details class="quote">
              <summary>Source code in <code>backend\processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_keywords</span><span class="p">(</span><span class="n">seed_texts</span><span class="p">,</span> <span class="n">num_keywords</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract the top &#39;num_keywords&#39; keywords from a list of documents using TF-IDF (Term Frequency-Inverse Document Frequency).</span>

<span class="sd">    This function performs the following steps:</span>
<span class="sd">    - Combines custom stop words with standard English stop words.</span>
<span class="sd">    - Initializes a TfidfVectorizer to convert the text data into a matrix of TF-IDF features, considering unigrams only.</span>
<span class="sd">    - Fits the TF-IDF model to the provided documents (seed_texts).</span>
<span class="sd">    - Sums the TF-IDF scores across all documents to rank the importance of each keyword.</span>
<span class="sd">    - Filters out numbers and stop words from the resulting keywords.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - seed_texts (list of str): A list where each element represents the (filtered) text of a document.</span>
<span class="sd">    - num_keywords (int): The number of top keywords to extract.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - list of dict: A list of dictionaries containing the top keywords and their corresponding TF-IDF scores.</span>
<span class="sd">      Each dictionary has two keys:</span>
<span class="sd">        - &#39;word&#39;: The keyword.</span>
<span class="sd">        - &#39;weight&#39;: The TF-IDF score, rounded to two decimal places.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Combine with English stop words from TfidfVectorizer</span>
    <span class="n">combined_stop_words</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ENGLISH_STOP_WORDS</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">additional_stop_words</span><span class="p">))</span>

    <span class="c1"># Initialize TfidfVectorizer with extended stop words and improved tokenization</span>
    <span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span>
        <span class="n">stop_words</span><span class="o">=</span><span class="n">combined_stop_words</span><span class="p">,</span>  <span class="c1"># Now a list</span>
        <span class="n">max_features</span><span class="o">=</span><span class="n">num_keywords</span><span class="p">,</span>
        <span class="n">token_pattern</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\b[a-zA-Z]{2,}\b&#39;</span><span class="p">,</span>  <span class="c1"># Tokens with at least two letters</span>
        <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># Include unigrams and bigrams</span>
        <span class="n">smooth_idf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">sublinear_tf</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># Fit and transform the list of documents</span>
    <span class="n">tfidf_matrix</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">seed_texts</span><span class="p">)</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>

    <span class="c1"># Sum TF-IDF scores across all documents</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">tfidf_matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">A1</span>  <span class="c1"># Convert to 1D array</span>
    <span class="n">keywords</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">scores</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Filter and select top keywords</span>
    <span class="n">filtered_keywords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">w</span> <span class="ow">in</span> <span class="n">combined_stop_words</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d&#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">filtered_keywords</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;word&#39;</span><span class="p">:</span> <span class="n">word</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="mi">2</span><span class="p">)})</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_keywords</span><span class="p">)</span> <span class="o">==</span> <span class="n">num_keywords</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">filtered_keywords</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="backend.processing.preprocess_text" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">preprocess_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Preprocess the input text by applying various cleaning and filtering steps for NLP tasks.</p>
<p>This function performs the following operations:
- Converts the text to lowercase.
- Removes URLs and numeric values.
- Utilizes spaCy for lemmatization, and filters out stop words, punctuation, and non-alphabetic tokens.
- Excludes tokens related to specific named entities (organizations, people, geopolitical entities, dates) and certain parts of speech (proper nouns, numbers).
- Custom stop words are also removed.</p>
<p>Parameters:
- text (str): The raw text to be processed.</p>
<p>Returns:
- str: A cleaned and preprocessed string where tokens have been lemmatized and unnecessary elements have been removed.</p>

            <details class="quote">
              <summary>Source code in <code>backend\processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preprocess the input text by applying various cleaning and filtering steps for NLP tasks.</span>

<span class="sd">    This function performs the following operations:</span>
<span class="sd">    - Converts the text to lowercase.</span>
<span class="sd">    - Removes URLs and numeric values.</span>
<span class="sd">    - Utilizes spaCy for lemmatization, and filters out stop words, punctuation, and non-alphabetic tokens.</span>
<span class="sd">    - Excludes tokens related to specific named entities (organizations, people, geopolitical entities, dates) and certain parts of speech (proper nouns, numbers).</span>
<span class="sd">    - Custom stop words are also removed.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - text (str): The raw text to be processed.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - str: A cleaned and preprocessed string where tokens have been lemmatized and unnecessary elements have been removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert text to lowercase</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1"># Remove URLs</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;http\S+|www\S+|https\S+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>

    <span class="c1"># Remove numbers</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b\d+\b&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>


    <span class="c1"># Use spaCy to process text and remove stop words, punctuation, etc.</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">cleaned_tokens</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">is_stop</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">is_punct</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">is_alpha</span><span class="p">:</span>
            <span class="c1"># Exclude certain named entities or tokens</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="ow">in</span> <span class="n">additional_stop_words</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">ent_type_</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;ORG&#39;</span><span class="p">,</span> <span class="s1">&#39;PERSON&#39;</span><span class="p">,</span> <span class="s1">&#39;GPE&#39;</span><span class="p">,</span> <span class="s1">&#39;DATE&#39;</span><span class="p">}:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;PROPN&#39;</span><span class="p">,</span> <span class="s1">&#39;NUM&#39;</span><span class="p">}:</span>
                <span class="k">continue</span>
            <span class="n">cleaned_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">lemma_</span><span class="p">)</span>

    <span class="n">cleaned_text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cleaned_tokens</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cleaned_text</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="backend.processing.scopus_sampling_process" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scopus_sampling_process</span><span class="p">(</span><span class="n">weight_dict</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">outer_iterations</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">progress_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scopus_api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Perform the sampling process using Scopus API with outer and inner iterations.</p>
<p>Parameters:
- weight_dict: Dict of keywords and their weights.
- threshold: The match count threshold.
- outer_iterations: Number of separate sampling runs.
- progress_callback: Function to call with progress updates.
- scopus_api_key: Dict containing 'apikey' and 'insttoken'.</p>
<p>Returns:
- ranked_papers: List of dictionaries containing paper information, sorted by occurrences.</p>

            <details class="quote">
              <summary>Source code in <code>backend\processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">scopus_sampling_process</span><span class="p">(</span><span class="n">weight_dict</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">outer_iterations</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">progress_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scopus_api_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform the sampling process using Scopus API with outer and inner iterations.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - weight_dict: Dict of keywords and their weights.</span>
<span class="sd">    - threshold: The match count threshold.</span>
<span class="sd">    - outer_iterations: Number of separate sampling runs.</span>
<span class="sd">    - progress_callback: Function to call with progress updates.</span>
<span class="sd">    - scopus_api_key: Dict containing &#39;apikey&#39; and &#39;insttoken&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - ranked_papers: List of dictionaries containing paper information, sorted by occurrences.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">scopus_api_key</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No Scopus API Key provided. Cannot perform real sampling.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">keywords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">weight_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">weight_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="n">paper_rank_counts</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">outer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">outer_iterations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Outer Iteration </span><span class="si">{</span><span class="n">outer</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
        <span class="n">search_keywords</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">selected_keyword</span> <span class="o">=</span> <span class="n">weighted_random_selection</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">selected_keyword</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No keyword selected. Ending inner iterations.&quot;</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="c1"># Prevent adding duplicate keywords</span>
            <span class="k">if</span> <span class="n">selected_keyword</span> <span class="ow">in</span> <span class="n">search_keywords</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Keyword &#39;</span><span class="si">{</span><span class="n">selected_keyword</span><span class="si">}</span><span class="s2">&#39; already in query. Selecting a different keyword.&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">search_keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selected_keyword</span><span class="p">)</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">construct_search_query</span><span class="p">(</span><span class="n">search_keywords</span><span class="p">)</span>
            <span class="n">match_count</span><span class="p">,</span> <span class="n">matched_papers</span> <span class="o">=</span> <span class="n">execute_search_scopus</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">scopus_api_key</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added &#39;</span><span class="si">{</span><span class="n">selected_keyword</span><span class="si">}</span><span class="s2">&#39; | Query: &#39;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&#39; | Matches: </span><span class="si">{</span><span class="n">match_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Update progress</span>
            <span class="k">if</span> <span class="n">progress_callback</span><span class="p">:</span>
                <span class="n">progress_callback</span><span class="p">(</span><span class="n">outer</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">match_count</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">match_count</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Match count </span><span class="si">{</span><span class="n">match_count</span><span class="si">}</span><span class="s2"> below threshold </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2">. Ending inner iterations.&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="c1"># Add a small delay to simulate processing time</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="c1"># Record matched papers from the final inner iteration</span>
        <span class="k">for</span> <span class="n">paper</span> <span class="ow">in</span> <span class="n">matched_papers</span><span class="p">:</span>
            <span class="n">scopus_id</span> <span class="o">=</span> <span class="n">paper</span><span class="p">[</span><span class="s1">&#39;scopus_id&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">scopus_id</span> <span class="ow">in</span> <span class="n">paper_rank_counts</span><span class="p">:</span>
                <span class="n">paper_rank_counts</span><span class="p">[</span><span class="n">scopus_id</span><span class="p">][</span><span class="s1">&#39;occurrences&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">paper</span><span class="p">[</span><span class="s1">&#39;occurrences&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">paper_rank_counts</span><span class="p">[</span><span class="n">scopus_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">paper</span>

            <span class="c1">#print(f&quot;Recorded paper: {scopus_id} | Current occurrences: {paper_rank_counts[scopus_id][&#39;occurrences&#39;]}&quot;)</span>

        <span class="c1"># Add a small delay after each outer iteration</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="c1"># Create a ranked list sorted by occurrences descending</span>
    <span class="n">ranked_papers</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">paper_rank_counts</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;occurrences&#39;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Sampling Completed ---&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ranked_papers</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="backend.processing.weighted_random_selection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">weighted_random_selection</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Select a keyword based on weights.</p>
<p>Parameters:
- keywords: List of keywords.
- weights: Corresponding list of weights.</p>
<p>Returns:
- Selected keyword or None if no selection possible.</p>

            <details class="quote">
              <summary>Source code in <code>backend\processing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">weighted_random_selection</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select a keyword based on weights.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - keywords: List of keywords.</span>
<span class="sd">    - weights: Corresponding list of weights.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - Selected keyword or None if no selection possible.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total_weight</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Total weight is zero. No keyword can be selected.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="o">/</span> <span class="n">total_weight</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">]</span>
    <span class="n">selected_keyword</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probabilities</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">selected_index</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">selected_keyword</span><span class="p">)</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">selected_index</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected keyword: &#39;</span><span class="si">{</span><span class="n">selected_keyword</span><span class="si">}</span><span class="s2">&#39; with weight </span><span class="si">{</span><span class="n">weight</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected keyword &#39;</span><span class="si">{</span><span class="n">selected_keyword</span><span class="si">}</span><span class="s2">&#39; not found in keywords list.&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">selected_keyword</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>